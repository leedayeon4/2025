import streamlit as st
import pandas as pd

# ----------------------------
# 1) ë°ì´í„°ë² ì´ìŠ¤ ì˜ˆì‹œ
# ----------------------------
content_db = [
    {"í‚¤ì›Œë“œ": "íŒ¨ì…˜", "íƒ€ê²Ÿ": "10ëŒ€", "ìœ í˜•": "SNS", "ì•„ì´ë””ì–´": "ì—¬ë¦„ í•œì • íŒ¨ì…˜ ì•„ì´í…œ ë¦¬ë·°", "ì „ëµ": "AIDA, FOMO"},
    {"í‚¤ì›Œë“œ": "íŒ¨ì…˜", "íƒ€ê²Ÿ": "20ëŒ€", "ìœ í˜•": "ë¸”ë¡œê·¸", "ì•„ì´ë””ì–´": "ì¶œê·¼ë£© ìŠ¤íƒ€ì¼ ê°€ì´ë“œ", "ì „ëµ": "ì°¸ì—¬ ìœ ë„, í•´ì‹œíƒœê·¸ í™œìš©"},
    {"í‚¤ì›Œë“œ": "IT", "íƒ€ê²Ÿ": "20ëŒ€", "ìœ í˜•": "ì˜ìƒ", "ì•„ì´ë””ì–´": "ì‹ ì œí’ˆ ì–¸ë°•ì‹± ì˜ìƒ", "ì „ëµ": "í˜¸ê¸°ì‹¬ ìê·¹, ìŠ¤í† ë¦¬í…”ë§"},
    {"í‚¤ì›Œë“œ": "ì—¬í–‰", "íƒ€ê²Ÿ": "ì§ì¥ì¸", "ìœ í˜•": "ë¸”ë¡œê·¸", "ì•„ì´ë””ì–´": "ì£¼ë§ ê·¼êµ ì—¬í–‰ ì¶”ì²œ", "ì „ëµ": "ë¬¸ì œ í•´ê²°, ì •ë³´ ì œê³µ"},
    {"í‚¤ì›Œë“œ": "ìŒì‹", "íƒ€ê²Ÿ": "ëª¨ë“  ì—°ë ¹", "ìœ í˜•": "SNS", "ì•„ì´ë””ì–´": "ë ˆì‹œí”¼ ì˜ìƒ ì‹œë¦¬ì¦ˆ", "ì „ëµ": "ì°¸ì—¬ ìœ ë„, êµìœ¡ì  ì½˜í…ì¸ "},
    {"í‚¤ì›Œë“œ": "ê²½ì œ", "íƒ€ê²Ÿ": "ëŒ€í•™ìƒ", "ìœ í˜•": "ë‰´ìŠ¤ë ˆí„°", "ì•„ì´ë””ì–´": "ì¬í…Œí¬ ê¸°ì´ˆ ê°€ì´ë“œ", "ì „ëµ": "êµìœ¡ì  ì½˜í…ì¸ , ìŠ¤í† ë¦¬í…”ë§"}
]

df_content = pd.DataFrame(content_db)

# ----------------------------
# 2) Streamlit UI
# ----------------------------
st.set_page_config(page_title="ì½˜í…ì¸  ì•„ì´ë””ì–´ ì¶”ì²œê¸°", page_icon="ğŸ’¡", layout="wide")
st.title("ğŸ’¡ ì½˜í…ì¸  ì•„ì´ë””ì–´ ì¶”ì²œê¸°")
st.markdown("ê´€ì‹¬ í‚¤ì›Œë“œ, íƒ€ê²Ÿì¸µ, ì½˜í…ì¸  ìœ í˜•, í•™ìŠµ í¬ì¸íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ê´€ë ¨ ì•„ì´ë””ì–´ì™€ ì „ëµì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!")

# ì‚¬ìš©ì ì…ë ¥
col1, col2 = st.columns(2)
with col1:
    keyword_input = st.text_input("í‚¤ì›Œë“œ ì…ë ¥ (ì˜ˆ: íŒ¨ì…˜, IT, ì—¬í–‰, ìŒì‹, ê²½ì œ)")
with col2:
    target_input = st.selectbox("íƒ€ê²Ÿì¸µ ì„ íƒ", ["10ëŒ€", "20ëŒ€", "ëŒ€í•™ìƒ", "ì§ì¥ì¸", "ëª¨ë“  ì—°ë ¹"])

content_type_input = st.multiselect("ì½˜í…ì¸  ìœ í˜• ì„ íƒ", ["ë¸”ë¡œê·¸", "SNS", "ì˜ìƒ", "ë‰´ìŠ¤ë ˆí„°"], default=["ë¸”ë¡œê·¸", "SNS"])

# ê²€ìƒ‰ ë²„íŠ¼
if st.button("ì¶”ì²œë°›ê¸°"):
    if keyword_input.strip() == "":
        st.warning("âš ï¸ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    else:
        # í•„í„°ë§
        filtered = df_content[
            (df_content["í‚¤ì›Œë“œ"].str.contains(keyword_input, case=False)) &
            (df_content["íƒ€ê²Ÿ"] == target_input) &
            (df_content["ìœ í˜•"].isin(content_type_input))
        ]

        if filtered.empty:
            st.info("ê´€ë ¨ ì•„ì´ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í‚¤ì›Œë“œ/íƒ€ê²Ÿ/ìœ í˜•ì„ ì„ íƒí•´ë³´ì„¸ìš”!")
        else:
            st.subheader("ì¶”ì²œ ì½˜í…ì¸  ì•„ì´ë””ì–´")
            for idx, row in filtered.iterrows():
                st.markdown(f"**ì•„ì´ë””ì–´:** {row['ì•„ì´ë””ì–´']}")
                st.markdown(f"- ì½˜í…ì¸  ìœ í˜•: {row['ìœ í˜•']}")
                st.markdown(f"- ì „ëµ/í•™ìŠµ í¬ì¸íŠ¸: {row['ì „ëµ']}")
                st.markdown("---")

            # CSV ë‹¤ìš´ë¡œë“œ
            csv = filtered.to_csv(index=False).encode('utf-8-sig')
            st.download_button(label="ì¶”ì²œ ì•„ì´ë””ì–´ CSV ë‹¤ìš´ë¡œë“œ", data=csv, file_name="ì¶”ì²œ_ì½˜í…ì¸ _ì•„ì´ë””ì–´.csv", mime="text/csv")

   
